CC = g++
OPTIMIZE = -O3 -DNDEBUG
DEBUG_CFLAGS = -g -O0 -D_DEBUG
PLATFORM_LINKFLAGS =
ADDL_LINKFLAGS =
LINKFLAGS_EXE = $(ADDL_LINKFLAGS)
LINKFLAGS_SO = -shared -Wl,-z,defs $(ADDL_LINKFLAGS)
PLATFORM_CFLAG =
PLATFORM_LFLAG =
TARGET_SUFFIX =
ADDL_CFLAGS =
CFLAGS = -std=c++11 $(OPTIMIZE) -fPIC -D_LINUX -Wno-write-strings $(PLATFORM_CFLAG) $(ADDL_CFLAGS)
# ADDLCFLAGS = -Wall -Wno-unknown-pragmas -Wno-strict-aliasing -Wno-non-virtual-dtor -Werror -msse
PLATFORM_DIR = x64
BUILD_DEF = -DAMDT_BUILD_SUFFIX=
MAKEFILENAME=makefile
DEBUG_RELEASE=release
INTERNAL_PUBLIC =
OUTPUT_DIR = $(DEPTH)/Output
OUTPUT_BIN_DIR = $(OUTPUT_DIR)/bin
OUTPUT_LIB_DIR = $(OUTPUT_DIR)/lib
OUTPUT_OBJ_DIR = $(OUTPUT_DIR)/obj
OBJ_DIR = $(OUTPUT_OBJ_DIR)/$(DEBUG_RELEASE)$(INTERNAL_PUBLIC)/$(PLATFORM_DIR)/$(PROJECT_NAME)
OUTPUT_DIRS_TO_CREATE = $(OBJ_DIR) $(OUTPUT_BIN_DIR) $(OUTPUT_LIB_DIR)

# Build defines
BASE_DEFINES = -D_LINUX -DUSE_POINTER_SINGLETON
ADDL_DEFINES =
ADDITIONAL_COMPILER_DEFINES_FROM_BUILD_SCRIPT =
BUILD_DEFINES = -DAMDT_PUBLIC -DAMDT_BUILD_SUFFIX=\"\"
PLATFORM_DEFINES = -DAMDT_PLATFORM_SUFFIX=\"\"
DEBUG_DEFINES = -DAMDT_DEBUG_SUFFIX=\"\"
DEFINES = $(BASE_DEFINES) $(BUILD_DEFINES) $(PLATFORM_DEFINES) $(DEBUG_DEFINES) $(ADDL_DEFINES) $(ADDITIONAL_COMPILER_DEFINES_FROM_BUILD_SCRIPT)

GPASRC_DIR=$(DEPTH)/Src
GPUPERFAPI_DIR=$(GPASRC_DIR)/GPUPerfAPI
GPACG_DIR = $(GPASRC_DIR)/GPUPerfAPICounterGenerator
GPACOMMON_DIR = $(GPASRC_DIR)/GPUPerfAPI-Common
GPADEVICEINFO_DIR = $(GPASRC_DIR)/DeviceInfo
GPACOUNTERS_DIR = $(GPASRC_DIR)/GPUPerfAPICounters

COMMON_DIR = $(DEPTH)/../Common
COMMON_SRC = $(COMMON_DIR)/Src
ATI_STREAM_SDK_DIR = $(COMMON_DIR)/Lib/AMD/APPSDK/3-0
HSA_DIR = /opt/rocm/hsa
DEVICEINFO_DIR = $(COMMON_SRC)/DeviceInfo
DEVICEINFOINTERNAL_DIR = $(COMMON_SRC)/DeviceInfo-Internal
ADL_DIR = $(COMMON_DIR)/Lib/AMD/ADL
ADLUTIL_DIR = $(COMMON_DIR)/Src/ADLUtil
AMDTMUTEX_DIR = $(COMMON_DIR)/Src/AMDTMutex
TSINGLETON_DIR = $(COMMON_SRC)/TSingleton
DYNAMICLIBRARYMODULE_DIR = $(COMMON_SRC)/DynamicLibraryModule
COMMON_LIB_EXT=$(COMMON_DIR)/Lib/Ext
GTEST_DIR = $(COMMON_LIB_EXT)/GoogleTest/1-7
GL_DIR = $(COMMON_LIB_EXT)/OpenGL
GTEST_DIR = $(COMMON_LIB_EXT)/GoogleTest/1-7
GTEST_LIBS = $(GTEST_DIR)/lib/gcc5/x64/libgtest.a
GTEST_LIBS32 = $(GTEST_DIR)/lib/gcc5/x86/libgtest.a
VK_SDK_DIR = $(VULKAN_SDK)
VK_INCLUDE_DIR = $(VK_SDK_DIR)/include
VK_LIB_DIR = $(VK_SDK_DIR)/lib
AMD_VK_EXT_DIR = $(COMMON_SRC)/AmdVkExt

# Lib paths
COMMON_LIB_PATHS = -L$(OUTPUT_LIB_DIR)
COMMON_DEVICEINFO_LIB = -Wl,--whole-archive $(OUTPUT_LIB_DIR)/libDeviceInfo$(TARGET_SUFFIX).a -Wl,--no-whole-archive
COMMON_LIBS = -lGPUPerfAPI-Common$(TARGET_SUFFIX) -lGPUPerfAPICounterGenerator$(TARGET_SUFFIX)
GPUPERFAPI_LIB = -Wl,--whole-archive -lGPUPerfAPI$(TARGET_SUFFIX) -Wl,--no-whole-archive
STANDARD_LIBS = -ldl -lpthread

# Build target overrides
X86_OVERRIDES = "PLATFORM_CFLAG = -m32 -msse2" "PLATFORM_LFLAG = -m32" "PLATFORM_DEFINES = -DX86 -DAMDT_PLATFORM_SUFFIX=\\\"32\\\"" "PLATFORM_DIR = x86" "GTEST_LIBS = $(GTEST_LIBS32)"
INTERNAL_OVERRIDES = "BUILD_DEFINES = -DAMDT_INTERNAL -DAMDT_BUILD_SUFFIX=\\\"-Internal\\\"" "INTERNAL_PUBLIC = _Internal"
DEBUG_OVERRIDES = "OPTIMIZE = $(DEBUG_CFLAGS)" "DEBUG_RELEASE = debug" "DEBUG_DEFINES = -DAMDT_DEBUG_SUFFIX=\\\"-d\\\" -DUSE_DEBUG_GPA"

BUILD_X86_OVERRIDES = "TARGET_SUFFIX = 32" "AMD_LIB_PATH = Bin/Linx86/" "AMD_LIB_SUFFIX = 32" $(X86_OVERRIDES)
BUILD_INTERNAL_OVERRIDES = "TARGET_SUFFIX = -Internal" "AMD_LIB_PATH = Bin-Internal/Linx64/" "AMD_LIB_SUFFIX = -Internal" $(INTERNAL_OVERRIDES)
BUILD_INTERNAL_X86_OVERRIDES = "TARGET_SUFFIX = 32-Internal" "AMD_LIB_PATH = Bin-Internal/Linx86/" "AMD_LIB_SUFFIX = 32-Internal" $(X86_OVERRIDES) $(INTERNAL_OVERRIDES)
BUILD_DEBUG_OVERRIDES = "TARGET_SUFFIX = -d" $(DEBUG_OVERRIDES)
BUILD_DEBUG_X86_OVERRIDES = "TARGET_SUFFIX = 32-d" "AMD_LIB_PATH = Bin/Linx86/" "AMD_LIB_SUFFIX = 32" $(DEBUG_OVERRIDES) $(X86_OVERRIDES)
BUILD_DEBUG_INTERNAL_OVERRIDES = "TARGET_SUFFIX = -d-Internal" "AMD_LIB_PATH = Bin-Internal/Linx64/" "AMD_LIB_SUFFIX = -Internal" $(INTERNAL_OVERRIDES) $(DEBUG_OVERRIDES)
BUILD_DEBUG_INTERNAL_X86_OVERRIDES = "TARGET_SUFFIX = 32-d-Internal" "AMD_LIB_PATH = Bin-Internal/Linx86/" "AMD_LIB_SUFFIX = 32-Internal" $(X86_OVERRIDES) $(INTERNAL_OVERRIDES) $(DEBUG_OVERRIDES)

